<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />
      	<link rel="shortcut icon" href="/resources/image/icon.png" />
		<link rel="apple-touch-icon" href="/resources/image/icon.png" />
		<!--[if lt IE 9]>
		<script src="/resources/js/html5shiv.js"></script>
		<![endif]-->
		<script type="text/javascript" src="/resources/include/js/common.js"></script>
		<script type="text/javascript" src="/resources/include/js/jquery-1.12.4.min.js"></script>
		<script type="text/javascript">
			let replyNum, message = "작성시 입력한 비밀번호를 입력해주세요!", btnkind="";
			/** 댓글 목록 보여주는 함수 */
			function listAll(b_num){
				$("#comment_list").html("");
				let url="/replies/all/"+b_num;
				
				$.getJSON(url, function(data){
				//function의 매개변수 이름은 임의적으로 정할 수 있음.(data)
					console.log("list count: "+data.length);
					replyCnt = data.length;
					$(data).each(function(){
						var r_num = this.r_num;
						var r_name = this.r_name;
						var r_content = this.r_content;
						var r_date = this.r_date;
						
						addNewItem(r_num, r_name, r_content, r_date);
					});
				}).fail(function(){
					alert("댓글 목록을 불러오는데 실패하였습니다. 잠시후에 다시 시도해주세요.");
				});
			}
			
			
			
			/* 새로운 글을 화면에 보여주기 위한 함수
				필요한 시점에 태그를 만들어서 사용할 수도 있다.(jquery 함수 특성)
				생성한 객체명에 주의하며 확인해야함(틀리면 큰일나용)
			*/
			function addNewItem(r_num, r_name, r_content, r_date){
				//새로운 값이 추가될 li태그 객체 생성
				let new_li = $("<li>");
				new_li.attr("data-num", r_num);
				//new_li.addClass("comment_item"); 
				//css 디자인 요소 부여할 클래스.(생략 가능)
				
				//작성자 정보가 저장될 <p>태그
				let writer_p=$("<p>");
				//writer_p.addClass("writer");
				
				//작성자 정보의 이름
				let name_span=$("<span>");
				name_span.html(r_name+" 님");
				//name_span.addClass("name");
				
				//작성일시
				var date_span = $("<span>");
				date_span.html(" / "+r_date+" ");
				
				//수정하기 버튼
				var up_input = $("<input>");
				up_input.attr({"type" : "button", "value" : "수정하기"});
				up_input.addClass("update_btn");
				//이 addClass는 버튼을 식별하기 위한 식별자로 사용할 class명임.(생략 X)
				
				//삭제하기 버튼
				var del_input = $("<input>");
				del_input.attr({"type" : "button", "value" : "삭제하기"});
				del_input.addClass("delete_btn");
				
				//내용
				var content_p = $("<p>");
				content_p.html(r_content);
				
			//위의 태그들 조립하기<li><p><span></span><span></span><input><input></p><p></p></li>
				writer_p.append(name_span).append(date_span).append(up_input).append(del_input)
				new_li.append(writer_p).append(content_p);
			//writer_p태그에 조립한 요소를 new_li태그에 다시 조립.
				$("#comment_list").append(new_li);
			//body에 있는 ul태그에 모두 조립한 new_li를 넣어준다.
			}
		</script>
		<title>댓글 화면</title>
	</head>
	<body>
		<div id="replyContainer">
			<div id="comment_write">
				<!-- 입력화면 구현하기 -->
			</div>
			<ul id="comment_list">
				<!-- 여기에 동적 생성 요소가 들어가게 됩니다. -->
			</ul>
		</div>
	</body>
</html>